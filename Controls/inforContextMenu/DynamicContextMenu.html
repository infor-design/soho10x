<!DOCTYPE html>
<html>
	<head>
		<!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge'><![endif]-->
		<meta charset="utf-8">

		<title>Infor Context Menu - Dynamic Context menu Content</title>
		<link href="../Release/inforControlsCombined.css" rel="stylesheet" />

		<script src="../Release/jquery-1.10.2.min.js"></script>
		<script src="../Release/jquery-ui-1.10.2.custom.min.js"></script>
		<script src="../Release/inforControlsCombined.js"></script>

		<script>
			$(function () {
				//set up context menus on the input fields when the dom is ready
				$("input").inforContextMenu({
						menu: 'inputMenu',
						beforeOpening: function(e,input){
							var menuElem = $('#inputMenu');
							menuElem.empty();
							menuElem.closest("div.inforMenu").hide();	//hide in case reopening

							if (input.attr("id")== "input1")
								menuElem.append('<li><a href="#doOpen">Open</a></li><li><a href="#doAttach">Attachment</a></li>');
							else if (input.attr("id")== "input2")
								menuElem.append('<li><a href="#dodelete">Delete</a></li><li><a href="#doSubmit">Submit</a></li><li><a href="#doElse">Something Else</a></li>');
							else
								menuElem.append('<li><a href="#doOpen">Open</a></li><li>');
						}
				});
			});

			function oncontext(evt, wnd)
			{
				/*
				Using oncontextmenu because we need the specefic "currentTarget",
				but this obviously isn't the proper way to go about the issue due to
				a sort of "double initialization" type issue where the first time through
				will create the dynamic menu and initialize the inforContextMenu which
				prepares it for the next click.
				*/
				var mElement = evt.currentTarget;
				var menu = document.getElementById("menuUL");

				if (!menu)
				{
					menu = document.createElement("ul");
					menu.id = "menuUL";
					menu.className = "inforContextMenu";
					wnd.document.body.appendChild(menu);
				}

				// showing that depending on the element clicked, we display context specific data
				if (mElement.id == "input1")
					menu.innerHTML = "<li><a href='#doOpen'>Open</a></li>" +
						"<li><a href='#doAttach'>Attachment</a></li>";
				else if (mElement.id == "input2")
					menu.innerHTML = "<li><a href='#doDelete'>Delete</a></li>" +
						"<li><a href='#doSubmit'>Submit</a></li>" +
						"<li><a href='#doElse'>Something Else</a></li>";
				else
					menu.innerHTML = "<li><a href='#doOpen'>Open</a></li>"

				// not sure when else to initialize
				$(mElement).inforContextMenu({
					menu: "menuUL"
				});
			}
		</script>
	</head>
	<body style='margin:2%'>
		<input type="text" id="input1" class="inforTextbox" value="Context test field 1" /><br><br>
		<input type="text" id="input2" class="inforTextbox" value="Context test field 1"/><br><br>
		<input type="text" id="inputNone" class="inforTextbox" value="Context test field none"/>

		<ul id="inputMenu" class="inforContextMenu">
		</ul>
	</body>
</html>